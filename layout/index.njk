{% extends '_layout.njk' %}

{% block title %}{{ config.title }}{% if config.subtitle %} - {{ config.subtitle }}{% endif %}{% endblock %}

{% block head %}
<script>
  (() => {
    // 生成随机颜色，确保两种颜色的差异明显
    function getRandomColor() {
      const letters = '0123456789ABCDEF';
      let color1, color2;
      do {
        color1 = '#';
        color2 = '#';
        for (let i = 0; i < 6; i++) {
          color1 += letters[Math.floor(Math.random() * 16)];
          color2 += letters[Math.floor(Math.random() * 16)];
        }
      } while (Math.abs(parseInt(color1, 16) - parseInt(color2, 16)) < 0x333333); // 确保两种颜色的差异明显
      return { color1, color2 };
    }
    // 应用随机渐变颜色
    function applyRandomGradient() {
      const links = document.querySelectorAll('.articles a.random-link');
      links.forEach(link => {
        const { color1: randomColor1, color2: randomColor2 } = getRandomColor();
        const gradient = `linear-gradient(135deg, ${randomColor1}, ${randomColor2})`;
        link.style.background = gradient;
      });
    }
    // 页面加载完毕后生成并应用随机渐变颜色
    window.addEventListener('DOMContentLoaded', applyRandomGradient);
    // 当窗口大小改变时重新生成并应用随机渐变颜色（可选）
    window.addEventListener('resize', applyRandomGradient);
  })();
</script>
{% endblock %}

{% block cover %}
{% if not page.prev %}
<div class="index-hover">
  <div class="index-card">
    <h1>{{ config.title }}</h1>
    {% if theme.avatar.url %}
    <div class="avatar-container">
      <img class="avatar" src="{{ url_for(theme.avatar.url) }}" alt="{{ config.author }}">
    </div>
    {% endif %}
    {% if config.subtitle %}
    <p>———— {{ config.subtitle }} ————</p>
    {% endif %}
    {% if config.description %}
    <p>{{ config.description }}</p>
    {% endif %}
    <!-- 文章列表 -->
    <div class="articles">
      <h2 class="title">我的文章</h2>
      {% for post in page.posts.toArray() %}
      {{ partial('_macro/post.njk', { post: post, is_card: true }) }}
      {% endfor %}
    </div>
  </div>
</div>
{% endif %}
{% endblock %}

{% block content %}
<div>
  {% for post in page.posts.toArray() %}
  {{ partial('_macro/post.njk', { post: post, is_index: true}) }}
  {% endfor %}
</div>
{% include '_partials/pagination.njk' %}
{% endblock %}